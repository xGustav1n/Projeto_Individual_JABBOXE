<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora</title>
    <link rel="stylesheet" href="./css/navbar.css">
    <link rel="stylesheet" href="./css/calculadora.css">
</head>
<body>

    <div class="header">
        <div class="container_header">
                <img class="logo" src="./img/logo.png" alt="JABBOX logo" />
                <div class="navbar">
                    <li>
                        <img class="header icone-home" src="./img/casa.png" alt="">
                        <a href="index2.html">Inicio</a>
                    </li>
                    <li class="paginaSelecionada">
                        <a href="calculadora.html">Calculadora</a>
                    </li>
                    <li>
                        <a href="ficha.html">Ficha</a>
                    </li>
                </div>
            </div>
        </div>

<div class="center">
    <div class="formulario">
        <div class="container">
            <h1 class="frase">Calculadora</h1>

        <div class="input">
            <input id="input_idade" type="text" name="" required="">
            <label>Idade</label>
        </div>  

        <div class="input">
            <input id="input_peso" type="text" name="" required="">
            <label>Peso</label>
        </div>  

        <div class="input">
            <input id="input_altura" type="text" name="" required="">
            <label>Altura</label>
        </div>  


        <button onclick="btnCalc()" class="btnCad">
            <h1>Enviar</h1>
        </button>

        <button onclick="btnCategorias()" class="btnCad">
            <h1>Categorias</h1>
        </button>

        <div id="divMen" class="resultadoIMC" style="text-decoration: underline;">Registros</div>

        <div id="div_resultado" class="resultadoIMC"></div>

        </div>
    </div>
</div>

</body>
</html>

<script>
    var fkUsuario = sessionStorage.ID_USUARIO;

    var imcEstado = "";
    var categoriaEscolhida = "";

    var imc = ["Magreza", "Normal", "Sobrepeso", "Obesidade", "Obesidade"];
    var categoria = ["Palha Ligeiro/Átomo", "Palha/Mini-Mosca", "Mosca Ligeiro", "Mosca", "Super Mosca", "Galo", "Super Galo", "Pena", "Super Pena", "Leve", "Super Leve", "Meio-Médio", "Super Meio-Médio", "Médio", "Super Médio", "Meio-Pesado", "Cruzador", "Pesado", "Super pesado"];

    function btnCategorias() {
        window.location.href = "dadosCategoria.html";
    }

    function btnCalc() {
        var idade = Number(input_idade.value);
        var peso = Number(input_peso.value);
        var altura = input_altura.value;


        if (idade == "" || peso == "" || altura == "") {
            alert("Mensagem de erro para todos os campos em branco")
        }
        else if (altura.indexOf('.') < 0) {
            alert("Formato de Altura invalido");
        } else {

            var resultadoIMC = peso / (altura*altura);

            if (resultadoIMC < 20) {
                div_resultado.innerHTML += `Seu imc - ${imc[0]} <br>
                                            Sua Massa Corpórea - ${resultadoIMC.toFixed(2)}Kg/m2 <br>`;
                                            imcEstado = imc[0];

            } else if (resultadoIMC > 20 && resultadoIMC <= 25) {
                div_resultado.innerHTML += `Seu imc - ${imc[1]} <br>
                                             Sua Massa Corpórea - ${resultadoIMC.toFixed(2)}Kg/m2 <br>`;
                                             imcEstado = imc[1];
            } else if (resultadoIMC > 25 && resultadoIMC <= 30) {
                div_resultado.innerHTML += `Seu imc - ${imc[2]} <xbr>
                                            Sua Massa Corpórea - ${resultadoIMC.toFixed(2)}Kg/m2 <br>`;
                                            imcEstado = imc[2];
            } else if (resultadoIMC > 30 && resultadoIMC <= 35) {
                div_resultado.innerHTML += `Seu imc - ${imc[3]} <br>
                                             Sua Massa Corpórea - ${resultadoIMC.toFixed(2)}Kg/m2 <br>`;
                                             imcEstado = imc[3];
            } else {
                div_resultado.innerHTML += `Seu imc - ${imc[4]} <br>
                                             Sua Massa Corpórea - ${resultadoIMC.toFixed(2)}Kg/m2 <br>`;
                                             imcEstado = imc[4];
            }
            // ----------------------------------------------------------------
           if (peso <= 46.03) {
                div_resultado.innerHTML += `Sua categoria para lutar: ${categoria[0]} <br><br>`;
                categoriaEscolhida = categoria[0];
           } else if (peso > 46.03 && peso <= 47.60) {
                div_resultado.innerHTML += `Sua categoria para lutar: ${categoria[1]} <br><br>`;
                categoriaEscolhida = categoria[1];
           } else if (peso > 47.60 && peso <= 48.99) {
                div_resultado.innerHTML += `Sua categoria para lutar: ${categoria[2]} <br><br>`;
                categoriaEscolhida = categoria[2];
           } else if (peso > 49.00 && peso <= 50.80) {
                div_resultado.innerHTML += `Sua categoria para lutar: ${categoria[3]} <br><br>`;
                categoriaEscolhida = categoria[3];
           } else if (peso > 50.80 && peso <= 52.20) {
                div_resultado.innerHTML += `Sua categoria para lutar: ${categoria[4]} <br><br>`;
                categoriaEscolhida = categoria[4];
           } else if (peso > 52.20 && peso <= 53.50) {
                div_resultado.innerHTML += `Sua categoria para lutar: ${categoria[5]} <br><br>`;
                categoriaEscolhida = categoria[5];
           } else if (peso > 53.50 && peso <= 55.30) {
                div_resultado.innerHTML += `Sua categoria para lutar: ${categoria[6]} <br><br>`;
                categoriaEscolhida = categoria[6];
           } else if (peso > 55.30 && peso <= 57.20) {
                div_resultado.innerHTML += `Sua categoria para lutar: ${categoria[7]} <br><br>`;
                categoriaEscolhida = categoria[7];
           } else if (peso > 57.20 && peso <= 59.00) {
                div_resultado.innerHTML += `Sua categoria para lutar: ${categoria[8]} <br><br>`;
                categoriaEscolhida = categoria[8];
           }  else if (peso > 59.00 && peso <= 61.20) {
                div_resultado.innerHTML += `Sua categoria para lutar: ${categoria[9]} <br><br>`;
                categoriaEscolhida = categoria[9];
           }  else if (peso > 61.20 && peso <= 63.50) {
                div_resultado.innerHTML += `Sua categoria para lutar: ${categoria[10]} <br><br>`;
                categoriaEscolhida = categoria[10];
           } else if (peso > 63.50 && peso <= 66.70) {
                div_resultado.innerHTML += `Sua categoria para lutar: ${categoria[11]} <br><br>`;
                categoriaEscolhida = categoria[11];
           } else if (peso > 66.70 && peso <= 69.90) {
                div_resultado.innerHTML += `Sua categoria para lutar: ${categoria[12]} <br><br>`;
                categoriaEscolhida = categoria[12];
           } else if (peso > 69.70 && peso <= 72.60) {
                div_resultado.innerHTML += `Sua categoria para lutar: ${categoria[13]} <br><br>`;
                categoriaEscolhida = categoria[13];
           } else if (peso > 72.60 && peso <= 76.20) {
                div_resultado.innerHTML += `Sua categoria para lutar: ${categoria[14]} <br><br>`;
                categoriaEscolhida = categoria[14];
           } else if (peso > 76.20 && peso <= 79.40) {
                div_resultado.innerHTML += `Sua categoria para lutar: ${categoria[15]} <br><br>`;
                categoriaEscolhida = categoria[15];
           } else if (peso > 79.40 && peso <= 90.70) {
                div_resultado.innerHTML += `Sua categoria para lutar: ${categoria[16]} <br><br>`;
                categoriaEscolhida = categoria[16];
           } else if (peso > 90.70 && peso <= 101.60) {
                div_resultado.innerHTML += `Sua categoria para lutar: ${categoria[17]} <br><br>`;
                categoriaEscolhida = categoria[17];
           } else {
                div_resultado.innerHTML += `Sua categoria para lutar: ${categoria[18]} <br><br>`;
                categoriaEscolhida = categoria[18];
           }

                fetch("/usuarios/cadastrarCategoria", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    idadeServer: idade,
                    pesoServer: peso,
                    alturaServer: altura,
                    imcEstadoServer: imcEstado,
                    resultadoIMCServer: resultadoIMC,
                    categoriaEscolhidaServer: categoriaEscolhida,
                    fkUsuarioServer: fkUsuario
                })
            }).then(function (resposta) {

            console.log("resposta: ", resposta);
            })

    }
}
</script>